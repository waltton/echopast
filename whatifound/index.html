<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>This Is What I Found Running A Honeypot</title>
</head>
<body>
    <h1>This Is What I Found Running A Honeypot</h1>
    <p>
        The goal of this website is to display some statistics about the data that I have been collecting with my honepots.
    </p>
    <p>
        I have a few different instances running, at the moment I'm sharing info from a simple webserver running on public cloud.
    </p>
    <p>
        DM me on twitter via @thishoneypot
    </p>
    <hr>
    <div>
        <p>
            Where are the requests going to?
            <ul>
                <li>1 - To the IP address via http (ip+http)</li>
                <li>2 - To the IP address via https (ip+https)</li>
                <li>3 - To the domain via http (d+http)</li>
                <li>4 - To the domain via https (d+https)</li>
                <li>5 - To the IP address with a different hostname via http (od+http)</li>
                <li>6 - To the IP address with a different hostname via https (od+https)</li>
            </ul>
        </p>
        <canvas id="data1Chart" style="max-height: 320px;"></canvas>
    </div>
    <hr>
    <div>
        <p>
            What clients are making requests?
        </p>
        <table id="data2table">
            <tr>
                <th rowspan="2">Current Week Rank</th>
                <th rowspan="2">User Agent Group</th>
                <th rowspan="2">Request Count Current Week</th>
                <th colspan="6">Where are the requests going to?</th>
            </tr>
            <tr>
                <th>ip+http</th>
                <th>ip+https</th>
                <th>d+http</th>
                <th>d+https</th>
                <th>od+http</th>
                <th>od+https</th>
            </tr>
        </table>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>
    <script>
        let data1 = [{"date" : "2022-10-14", "data" : {"1" : 79, "2" : 48, "3" : 0, "4" : 0, "5" : 1, "6" : 0}}, {"date" : "2022-10-13", "data" : {"1" : 159, "2" : 70, "3" : 0, "4" : 6, "5" : 2, "6" : 12}}, {"date" : "2022-10-12", "data" : {"1" : 377, "2" : 69, "3" : 0, "4" : 11, "5" : 1, "6" : 1}}, {"date" : "2022-10-11", "data" : {"1" : 150, "2" : 81, "3" : 0, "4" : 10, "5" : 2, "6" : 1}}, {"date" : "2022-10-10", "data" : {"1" : 134, "2" : 95, "3" : 0, "4" : 7, "5" : 4, "6" : 14}}, {"date" : "2022-10-09", "data" : {"1" : 107, "2" : 69, "3" : 0, "4" : 21, "5" : 3, "6" : 2}}, {"date" : "2022-10-08", "data" : {"1" : 120, "2" : 75, "3" : 0, "4" : 5, "5" : 1, "6" : 6}}, {"date" : "2022-10-07", "data" : {"1" : 165, "2" : 89, "3" : 0, "4" : 11, "5" : 0, "6" : 0}}, {"date" : "2022-10-06", "data" : {"1" : 159, "2" : 77, "3" : 0, "4" : 14, "5" : 0, "6" : 0}}, {"date" : "2022-10-05", "data" : {"1" : 1206, "2" : 82, "3" : 0, "4" : 6, "5" : 6, "6" : 1}}, {"date" : "2022-10-04", "data" : {"1" : 106, "2" : 65, "3" : 0, "4" : 5, "5" : 3, "6" : 0}}, {"date" : "2022-10-03", "data" : {"1" : 150, "2" : 59, "3" : 0, "4" : 14, "5" : 5, "6" : 4}}, {"date" : "2022-10-02", "data" : {"1" : 72, "2" : 37, "3" : 0, "4" : 0, "5" : 1, "6" : 0}}, {"date" : "2022-10-01", "data" : {"1" : 101, "2" : 84, "3" : 0, "4" : 3, "5" : 1, "6" : 8}}, {"date" : "2022-09-30", "data" : {"1" : 99, "2" : 57, "3" : 0, "4" : 14, "5" : 7, "6" : 0}}, {"date" : "2022-09-29", "data" : {"1" : 129, "2" : 52, "3" : 0, "4" : 2, "5" : 5, "6" : 3}}, {"date" : "2022-09-28", "data" : {"1" : 116, "2" : 111, "3" : 0, "4" : 2, "5" : 1, "6" : 29}}, {"date" : "2022-09-27", "data" : {"1" : 127, "2" : 40, "3" : 0, "4" : 3, "5" : 15, "6" : 1}}, {"date" : "2022-09-26", "data" : {"1" : 162, "2" : 62, "3" : 0, "4" : 5, "5" : 1, "6" : 0}}, {"date" : "2022-09-25", "data" : {"1" : 187, "2" : 46, "3" : 0, "4" : 9, "5" : 2, "6" : 3}}, {"date" : "2022-09-24", "data" : {"1" : 196, "2" : 76, "3" : 0, "4" : 10, "5" : 6, "6" : 22}}, {"date" : "2022-09-23", "data" : {"1" : 57, "2" : 37, "3" : 0, "4" : 9, "5" : 2, "6" : 1}}, {"date" : "2022-09-22", "data" : {"1" : 0, "2" : 51, "3" : 0, "4" : 6, "5" : 0, "6" : 3}}, {"date" : "2022-09-21", "data" : {"1" : 0, "2" : 45, "3" : 0, "4" : 6, "5" : 0, "6" : 0}}, {"date" : "2022-09-20", "data" : {"1" : 0, "2" : 45, "3" : 0, "4" : 10, "5" : 0, "6" : 0}}, {"date" : "2022-09-19", "data" : {"1" : 0, "2" : 64, "3" : 0, "4" : 26, "5" : 0, "6" : 5}}, {"date" : "2022-09-18", "data" : {"1" : 0, "2" : 46, "3" : 0, "4" : 71, "5" : 0, "6" : 0}}, {"date" : "2022-09-17", "data" : {"1" : 0, "2" : 35, "3" : 0, "4" : 9, "5" : 0, "6" : 0}}, {"date" : "2022-09-16", "data" : {"1" : 0, "2" : 39, "3" : 0, "4" : 13, "5" : 0, "6" : 0}}, {"date" : "2022-09-15", "data" : {"1" : 0, "2" : 30, "3" : 0, "4" : 9, "5" : 0, "6" : 0}}]
        let data2 = [{"user_agent_group" : "Chrome", "count_current_week" : 1166, "count_last_week" : 912, "rank_current_week" : 1, "rank_last_week" : 1, "delta" : 0, "c1" : 986, "c2" : 130, "c3" : 0, "c4" : 25, "c5" : 6, "c6" : 19}, {"user_agent_group" : "Edge", "count_current_week" : 255, "count_last_week" : 1, "rank_current_week" : 2, "rank_last_week" : 30, "delta" : 28, "c1" : 81, "c2" : 0, "c3" : 0, "c4" : 0, "c5" : 174, "c6" : 0}, {"user_agent_group" : "Safari", "count_current_week" : 220, "count_last_week" : 205, "rank_current_week" : 3, "rank_last_week" : 3, "delta" : 0, "c1" : 26, "c2" : 186, "c3" : 0, "c4" : 3, "c5" : 2, "c6" : 3}, {"user_agent_group" : "Firefox", "count_current_week" : 215, "count_last_week" : 209, "rank_current_week" : 4, "rank_last_week" : 2, "delta" : -2, "c1" : 171, "c2" : 36, "c3" : 0, "c4" : 6, "c5" : 2, "c6" : 0}, {"user_agent_group" : "", "count_current_week" : 119, "count_last_week" : 94, "rank_current_week" : 5, "rank_last_week" : 5, "delta" : 0, "c1" : 85, "c2" : 30, "c3" : 0, "c4" : 1, "c5" : 3, "c6" : 0}, {"user_agent_group" : "zgrab", "count_current_week" : 97, "count_last_week" : 105, "rank_current_week" : 6, "rank_last_week" : 4, "delta" : -2, "c1" : 23, "c2" : 74, "c3" : 0, "c4" : 0, "c5" : 0, "c6" : 0}, {"user_agent_group" : "CensysInspect", "count_current_week" : 59, "count_last_week" : 55, "rank_current_week" : 7, "rank_last_week" : 6, "delta" : -1, "c1" : 36, "c2" : 19, "c3" : 0, "c4" : 4, "c5" : 0, "c6" : 0}, {"user_agent_group" : "Go http client", "count_current_week" : 48, "count_last_week" : 34, "rank_current_week" : 8, "rank_last_week" : 9, "delta" : 1, "c1" : 25, "c2" : 23, "c3" : 0, "c4" : 0, "c5" : 0, "c6" : 0}, {"user_agent_group" : "Python requests", "count_current_week" : 46, "count_last_week" : 37, "rank_current_week" : 9, "rank_last_week" : 8, "delta" : -1, "c1" : 17, "c2" : 29, "c3" : 0, "c4" : 0, "c5" : 0, "c6" : 0}, {"user_agent_group" : "curl", "count_current_week" : 41, "count_last_week" : 6, "rank_current_week" : 10, "rank_last_week" : 16, "delta" : 6, "c1" : 41, "c2" : 0, "c3" : 0, "c4" : 0, "c5" : 0, "c6" : 0}, {"user_agent_group" : "Expanse", "count_current_week" : 35, "count_last_week" : 30, "rank_current_week" : 11, "rank_last_week" : 10, "delta" : -1, "c1" : 20, "c2" : 11, "c3" : 0, "c4" : 4, "c5" : 0, "c6" : 0}, {"user_agent_group" : "Python urllib", "count_current_week" : 22, "count_last_week" : 25, "rank_current_week" : 12, "rank_last_week" : 11, "delta" : -1, "c1" : 0, "c2" : 22, "c3" : 0, "c4" : 0, "c5" : 0, "c6" : 0}, {"user_agent_group" : "Hello World", "count_current_week" : 20, "count_last_week" : 47, "rank_current_week" : 13, "rank_last_week" : 7, "delta" : -6, "c1" : 20, "c2" : 0, "c3" : 0, "c4" : 0, "c5" : 0, "c6" : 0}, {"user_agent_group" : "Linux Gnu (cow)", "count_current_week" : 19, "count_last_week" : 10, "rank_current_week" : 14, "rank_last_week" : 12, "delta" : -2, "c1" : 19, "c2" : 0, "c3" : 0, "c4" : 0, "c5" : 0, "c6" : 0}, {"user_agent_group" : "Quic Go", "count_current_week" : 9, "count_last_week" : 8, "rank_current_week" : 15, "rank_last_week" : 14, "delta" : -1, "c1" : 0, "c2" : 9, "c3" : 0, "c4" : 0, "c5" : 0, "c6" : 0}]

        data1 = data1.sort(x => x.date).reverse()

        const config = {
            type: 'line',
            data: {
                datasets: [{
                    label: '1 ip+http',
                    data: data1.map(x => ({x: x.date, y: x.data["1"]})),
                    borderColor: "#004c6d",
                    backgroundColor: "#004c6d",
                },{
                    label: '2 ip+https',
                    data: data1.map(x => ({x: x.date, y: x.data["2"]})),
                    borderColor: "#346888",
                    backgroundColor: "#346888",
                },{
                    label: '3 d+http',
                    data: data1.map(x => ({x: x.date, y: x.data["3"]})),
                    borderColor: "#5886a5",
                    backgroundColor: "#5886a5",
                },{
                    label: '4 d+https',
                    data: data1.map(x => ({x: x.date, y: x.data["4"]})),
                    borderColor: "#7aa6c2",
                    backgroundColor: "#7aa6c2",
                },{
                    label: '5 od+http',
                    data: data1.map(x => ({x: x.date, y: x.data["5"]})),
                    borderColor: "#9dc6e0",
                    backgroundColor: "#9dc6e0",
                },{
                    label: '6 od+https',
                    data: data1.map(x => ({x: x.date, y: x.data["6"]})),
                    borderColor: "#c1e7ff",
                    backgroundColor: "#c1e7ff",
                }]
            },
            options: {
                responsive: true,
                plugins: {
                    legend: {
                        position: 'top',
                    },
                }
            },
        };

        const data1ctx = document.getElementById('data1Chart').getContext('2d');
        new Chart(data1ctx, config);

        const data2table = document.getElementById('data2table');
        data2.forEach(x => {
            let row = data2table.insertRow();
            row.insertCell().innerText = x.rank_current_week + " (" + (x.delta > 0 ? "+"  : "") + x.delta + ")";
            row.insertCell().innerText = x.user_agent_group;
            row.insertCell().innerText = x.count_current_week;

            for (let i=1; i<=6;i++){
                let c = row.insertCell()
                c.innerText = `${(x['c'+i] / x.count_current_week * 100).toFixed(0)} %`;
                c.setAttribute("style", `background: hsl(198deg 100% ${(75 - x['c'+i] / x.count_current_week * 50).toFixed(0)}%);`);
            }
        });
        </script>
        <!-- Google tag (gtag.js) -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-D0192WFG4S"></script>
        <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-D0192WFG4S');
    </script>
    <style>
        table, th, td {
            border: 1px solid;
        }
        table {
            width: 100%;
        }
        #data2table td:nth-child(n+3) {
           text-align: right;
        }
    </style>
</body>
</html>